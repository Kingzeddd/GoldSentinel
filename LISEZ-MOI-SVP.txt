# GoldSentinel - Syst√®me de D√©tection d'Orpaillage par Satellite

## Table des Mati√®res
1.  [But du Projet](#but-du-projet)
2.  [Architecture G√©n√©rale](#architecture-generale)
3.  [Pr√©requis](#prerequis)
4.  [Installation et Lancement](#installation-et-lancement)
    *   [Backend (Django/Celery)](#backend-djangocelery)
        *   [Avec Docker (Recommand√©)](#avec-docker-recommand√©)
        *   [Manuellement](#manuellement)
    *   [Frontend (React/Vite)](#frontend-reactvite)
5.  [Utilisation des Fonctionnalit√©s Frontend](#utilisation-des-fonctionnalites-frontend)
    *   [Connexion](#connexion)
    *   [Tableau de Bord](#tableau-de-bord)
    *   [Gestion des D√©tections](#gestion-des-detections)
    *   [Gestion des Investigations](#gestion-des-investigations)
    *   [Gestion des Images Satellites](#gestion-des-images-satellites)
    *   [Analyse Spectrale](#analyse-spectrale)
    *   [Gestion des Alertes](#gestion-des-alertes)
    *   [Gestion des R√©gions](#gestion-des-regions)
    *   [G√©n√©ration de Rapports](#generation-de-rapports)
    *   [Statistiques D√©taill√©es](#statistiques-detaillees)
    *   [Gestion de Compte Utilisateur](#gestion-de-compte-utilisateur)
    *   [Analyse de Risque Financier](#analyse-de-risque-financier)
    *   [Journal des √âv√©nements](#journal-des-evenements)
6.  [Commandes d'Administration Backend (Avanc√©)](#commandes-dadministration-backend-avance)
    *   [Cr√©er des Utilisateurs par D√©faut](#creer-des-utilisateurs-par-defaut)
    *   [Ingestion des Nouvelles Images Satellites (GEE)](#ingestion-des-nouvelles-images-satellites-gee)
    *   [Services d'Arri√®re-plan (Celery)](#services-darriere-plan-celery)

---

## 1. But du Projet <a name="but-du-projet"></a>

GoldSentinel est un syst√®me con√ßu pour la **d√©tection et le suivi des activit√©s d'orpaillage ill√©gal** en utilisant l'imagerie satellite fournie par Google Earth Engine (GEE). Le syst√®me combine des techniques d'analyse spectrale avec des mod√®les d'intelligence artificielle (TensorFlow) pour identifier les sites miniers potentiels. Il offre une plateforme compl√®te pour la gestion des d√©tections, le lancement d'investigations, la visualisation de donn√©es g√©ospatiales et la g√©n√©ration de rapports.

L'objectif principal est de fournir aux autorit√©s comp√©tentes un outil technologique pour surveiller les zones √©tendues, identifier rapidement les nouvelles activit√©s mini√®res et orienter les interventions sur le terrain.

---

## 2. Architecture G√©n√©rale <a name="architecture-generale"></a>

Le syst√®me est compos√© de :
*   Un **Backend** d√©velopp√© avec Django (Python), servant une API REST pour la logique m√©tier, la gestion des donn√©es et l'int√©gration de l'IA. Il utilise PostgreSQL/PostGIS pour le stockage des donn√©es et Celery avec Redis pour la gestion des t√¢ches asynchrones (traitement d'images, rapports, etc.).
*   Un **Frontend** d√©velopp√© avec React (TypeScript) et Vite, offrant une interface utilisateur web interactive pour la visualisation des donn√©es, la gestion des alertes, des d√©tections, etc.
*   **Google Earth Engine (GEE)** comme source de donn√©es pour l'imagerie satellite.
*   Un mod√®le **TensorFlow** pour l'analyse d'images et la d√©tection.

---

## 3. Pr√©requis <a name="prerequis"></a>

*   **Docker et Docker Compose:** Fortement recommand√©s pour faciliter le d√©ploiement de l'environnement backend.
*   **Node.js et npm:** N√©cessaires pour le d√©veloppement et le lancement du frontend.
*   **Acc√®s √† Google Earth Engine:** Un compte de service Google Cloud avec les API GEE activ√©es et les informations d'identification (`secrets/earthengine-credentials.json` ou `secrets/gee-service-account-key.json` - v√©rifiez le nom exact dans `docker-compose.yml` ou la configuration Django).
*   **Navigateur Web Moderne:** Chrome, Firefox, Edge, etc.

---

## 4. Installation et Lancement <a name="installation-et-lancement"></a>

### Backend (Django/Celery) <a name="backend-djangocelery"></a>

#### Avec Docker (Recommand√©) <a name="avec-docker-recommand√©"></a>

Cette m√©thode g√®re le backend, la base de donn√©es (PostgreSQL/PostGIS) et Redis (pour Celery).

1.  **Clonez le d√©p√¥t** (si ce n'est pas d√©j√† fait).
2.  **Placez vos identifiants Google Earth Engine:** Assurez-vous que le fichier d'identifiants (par exemple, `secrets/earthengine-credentials.json`) est correctement plac√© et r√©f√©renc√© dans `docker-compose.yml`.
3.  **Lancez Docker Compose:**
    ```bash
    docker-compose up --build -d
    ```
    Le `-d` lance les services en arri√®re-plan. Utilisez `docker-compose logs -f` pour suivre les journaux.
4.  Le backend Django sera accessible √† `http://localhost:8000`.
5.  Les migrations de base de donn√©es devraient s'appliquer automatiquement. Sinon, ex√©cutez :
    ```bash
    docker-compose exec app python manage.py migrate
    ```
6.  Pour cr√©er les utilisateurs par d√©faut et les donn√©es de d√©monstration (recommand√© pour une premi√®re utilisation) :
    ```bash
    docker-compose exec app python manage.py create_default_users --demo
    ```

#### Manuellement <a name="manuellement"></a>

Cette m√©thode est plus complexe et g√©n√©ralement utilis√©e pour le d√©veloppement direct sur le backend.

1.  **Installez les d√©pendances Python:**
    ```bash
    pip install -r requirements.txt
    ```
2.  **Configurez et lancez PostgreSQL avec l'extension PostGIS.**
3.  **Configurez et lancez Redis.**
4.  **Configurez les variables d'environnement:**
    Cr√©ez un fichier `.env` √† la racine du projet ou exportez les variables n√©cessaires pour la base de donn√©es, Redis, les identifiants GEE, etc. (consultez `config/settings.py` et `docker-compose.yml` pour les variables attendues).
5.  **Appliquez les migrations de la base de donn√©es:**
    ```bash
    python manage.py migrate
    ```
6.  **Lancez le serveur Django:**
    ```bash
    python manage.py runserver 0.0.0.0:8000
    ```
7.  **Lancez les services Celery** (voir la section [Services d'Arri√®re-plan](#services-darriere-plan-celery) plus bas).

### Frontend (React/Vite) <a name="frontend-reactvite"></a>

1.  **Naviguez vers le dossier frontend:**
    ```bash
    cd frontend
    ```
2.  **Installez les d√©pendances Node.js:**
    ```bash
    npm install
    ```
    (ou `yarn install` si vous utilisez Yarn)
3.  **Lancez le serveur de d√©veloppement Vite:**
    ```bash
    npm run dev
    ```
4.  Le frontend sera g√©n√©ralement accessible √† `http://localhost:5173` (Vite indiquera l'URL exacte dans la console).
5.  Assurez-vous que l'URL du backend vers laquelle le frontend fait des requ√™tes est correctement configur√©e (g√©n√©ralement dans `frontend/src/config/index.ts` ou via des variables d'environnement Vite `VITE_API_URL`). Par d√©faut, il devrait pointer vers `http://localhost:8000/api/v1`.

---

## 5. Utilisation des Fonctionnalit√©s Frontend <a name="utilisation-des-fonctionnalites-frontend"></a>

Une fois le backend et le frontend lanc√©s, vous pouvez acc√©der √† l'application via l'URL du frontend.

### Connexion <a name="connexion"></a>
*   **Page:** `/login`
*   **Description:** Permet aux utilisateurs de se connecter avec leurs identifiants. Les utilisateurs par d√©faut sont cr√©√©s via la commande `create_default_users` (voir section Administration Backend).

### Tableau de Bord <a name="tableau-de-bord"></a>
*   **Page:** `/` (ou `/dashboard`)
*   **Description:** Page d'accueil apr√®s connexion. Affiche un r√©sum√© des informations cl√©s, des statistiques et potentiellement des alertes r√©centes.

### Gestion des D√©tections <a name="gestion-des-detections"></a>
*   **Page:** `/detections`
*   **Description:** Affiche la liste des d√©tections d'orpaillage. Permet de visualiser les d√©tails de chaque d√©tection (localisation, date, score de confiance, image satellite associ√©e). Les utilisateurs peuvent potentiellement filtrer, trier les d√©tections et fournir un feedback sur leur validit√©.

### Gestion des Investigations <a name="gestion-des-investigations"></a>
*   **Page:** `/investigations`
*   **Description:** Permet de suivre les investigations lanc√©es suite √† des d√©tections. Les utilisateurs peuvent voir les investigations en cours, assign√©es, et leur statut. Il peut √™tre possible de cr√©er de nouvelles investigations ou de mettre √† jour celles existantes.

### Gestion des Images Satellites <a name="gestion-des-images-satellites"></a>
*   **Page:** `/images`
*   **Description:** Catalogue des images satellites ing√©r√©es par le syst√®me. Permet de visualiser les images, leurs m√©tadonn√©es (date, r√©gion, source GEE) et potentiellement de lancer des analyses.

### Analyse Spectrale <a name="analyse-spectrale"></a>
*   **Page:** `/spectral` ou via un lien depuis une d√©tection/image.
*   **Description:** Fournit des outils de visualisation et d'analyse des indices spectraux (NDVI, NDWI, NDTI).
    *   **Cartes Spectrales (`SpectralMap`):** Affiche les indices sous forme de couches cartographiques interactives, superpos√©es √† une carte de base (OpenStreetMap). Permet de naviguer, zoomer et inspecter visuellement les zones.
    *   **Graphiques Spectraux (`SpectralCharts`):** Affiche les valeurs des indices sous forme de graphiques (barres pour les valeurs actuelles, courbes pour l'√©volution temporelle sur une r√©gion). Aide √† interpr√©ter l'√©tat de la v√©g√©tation, de l'eau et du sol.

### Gestion des Alertes <a name="gestion-des-alertes"></a>
*   **Page:** `/alerts`
*   **Description:** Liste les alertes g√©n√©r√©es par le syst√®me (par exemple, nouvelles d√©tections √† haut risque, anomalies financi√®res). Permet aux utilisateurs de consulter les d√©tails des alertes et de les marquer comme trait√©es.

### Gestion des R√©gions <a name="gestion-des-regions"></a>
*   **Page:** `/regions`
*   **Description:** Permet de d√©finir et de g√©rer les r√©gions g√©ographiques d'int√©r√™t pour la surveillance. Les analyses et d√©tections sont souvent associ√©es √† ces r√©gions.

### G√©n√©ration de Rapports <a name="generation-de-rapports"></a>
*   **Page:** `/reports`
*   **Description:** Permet de g√©n√©rer des rapports (par exemple, au format CSV) sur les d√©tections, investigations ou autres donn√©es du syst√®me, potentiellement sur des p√©riodes ou r√©gions sp√©cifiques.

### Statistiques D√©taill√©es <a name="statistiques-detaillees"></a>
*   **Page:** `/stats`
*   **Description:** Fournit une vue plus approfondie des statistiques du syst√®me, avec des graphiques et des chiffres sur les tendances des d√©tections, l'efficacit√© des investigations, etc.

### Gestion de Compte Utilisateur <a name="gestion-de-compte-utilisateur"></a>
*   **Page:** `/account` (ou `/profile`)
*   **Description:** Permet √† l'utilisateur de g√©rer les informations de son profil, comme le changement de mot de passe.

### Analyse de Risque Financier <a name="analyse-de-risque-financier"></a>
*   **Int√©gr√©e potentiellement dans les pages D√©tections ou Alertes.**
*   **Description:** Le syst√®me peut inclure des fonctionnalit√©s pour √©valuer ou afficher le risque financier associ√© aux activit√©s d'orpaillage d√©tect√©es. Les d√©tails de cette fonctionnalit√© seraient visibles via les services (`financial-risk.service.ts`) et les API correspondantes.

### Journal des √âv√©nements <a name="journal-des-evenements"></a>
*   **Potentiellement une section d√©di√©e ou int√©gr√©e.**
*   **Description:** Affiche un journal des actions importantes des utilisateurs ou des √©v√©nements syst√®me, utile pour l'audit et le suivi.

---

## 6. Commandes d'Administration Backend (Avanc√©) <a name="commandes-dadministration-backend-avance"></a>

Ces commandes sont √† ex√©cuter via `python manage.py ...` (en local) ou `docker-compose exec app python manage.py ...` (avec Docker).

### Cr√©er des Utilisateurs par D√©faut <a name="creer-des-utilisateurs-par-defaut"></a>

1- Cr√©ation simple des utilisateurs par d√©faut :
   `python manage.py create_default_users`

   R√©sultat : Cr√©e les utilisateurs par d√©faut (Responsable, Agent de Terrain, etc.) et leurs autorit√©s associ√©es si non existants.

##########################################

2- Forcer la recr√©ation des utilisateurs (R√©initialisation) :
   `python manage.py create_default_users --force`

   R√©sultat :
   üóëÔ∏è Supprime les utilisateurs non-superutilisateurs existants, leurs autorit√©s, et les donn√©es de d√©monstration associ√©es (investigations, d√©tections, images de d√©mo).
   ‚úÖ Recr√©e les utilisateurs et autorit√©s par d√©faut.
   üí° Utile pour r√©initialiser les mots de passe et repartir sur une base de donn√©es utilisateurs propre pour la d√©mo.

############################################

3- Cr√©er utilisateurs et donn√©es de d√©monstration :
   `python manage.py create_default_users --demo`

   R√©sultat :
   ‚úÖ Cr√©e ou met √† jour les utilisateurs et autorit√©s par d√©faut.
   üõ∞Ô∏è  Assure l'existence de la r√©gion "BONDOUKOU".
   üì∏ Cr√©e une image satellite d'exemple pour Bondoukou.
   üéØ Cr√©e une d√©tection d'orpaillage d'exemple.
   üîç Cr√©e une investigation d'exemple, assign√©e √† un agent de terrain.
   üí° Id√©al pour une d√©monstration compl√®te du flux de travail du syst√®me !

### Ingestion des Nouvelles Images Satellites (GEE) <a name="ingestion-des-nouvelles-images-satellites-gee"></a>

############################################
INGESTION DES NOUVELLES IMAGES SATELLITES
############################################

4- Scanner et traiter les nouvelles images GEE :
   `python manage.py ingest_new_gee_images`

   R√©sultat :
   üõ∞Ô∏è Interroge Google Earth Engine pour les images satellites r√©centes.
   ‚ûï Identifie les nouvelles images non encore trait√©es et les ajoute √† la file d'attente pour traitement asynchrone (calcul des indices spectraux, etc.).
   üí° Cette commande doit √™tre ex√©cut√©e p√©riodiquement (par exemple, via une t√¢che cron syst√®me ou manuellement de temps en temps) pour que le syst√®me reste √† jour avec les derni√®res images disponibles.

### Services d'Arri√®re-plan (Celery) <a name="services-darriere-plan-celery"></a>

############################################
IMPORTANT : SERVICES D'ARRI√àRE-PLAN (CELERY)
############################################

Pour le fonctionnement optimal et complet du syst√®me, en particulier pour les op√©rations asynchrones et les t√¢ches planifi√©es, les services Celery suivants doivent √™tre actifs et op√©rationnels.

Avant de lancer ces services, assurez-vous que votre broker de messages (par exemple, Redis ou RabbitMQ) est correctement configur√© dans `config/settings.py` (via les variables d'environnement `CELERY_BROKER_URL` et `CELERY_RESULT_BACKEND`) et qu'il est en cours d'ex√©cution.

1. **Celery Worker (Ex√©cuteur de T√¢ches)**:
   Ce service ex√©cute les t√¢ches longues ou gourmandes en ressources en arri√®re-plan, telles que le traitement des images GEE, la g√©n√©ration de rapports, etc.
   Pour le d√©marrer (depuis la racine du projet, si ex√©cution manuelle) :
   `celery -A config worker -l info`
   (Avec Docker, ce service est g√©r√© par `docker-compose.yml` sous le nom `worker`)

2. **Celery Beat (Planificateur de T√¢ches)**:
   Ce service est responsable du lancement des t√¢ches p√©riodiques, comme la mise √† jour quotidienne des statistiques du tableau de bord.
   Pour le d√©marrer (depuis la racine du projet, si ex√©cution manuelle) :
   `celery -A config beat -l info --scheduler django_celery_beat.schedulers:DatabaseScheduler`
   (Avec Docker, ce service n'est pas explicitement d√©fini dans le `docker-compose.yml` fourni. Si des t√¢ches planifi√©es persistantes sont n√©cessaires (ex: via `django-celery-beat`), ce service devra √™tre lanc√©. Cela peut √™tre fait en ajoutant un nouveau service √† `docker-compose.yml` ou en l'ex√©cutant manuellement dans le conteneur `app` ou `worker`.)

   *(Note : L'utilisation de `django_celery_beat.schedulers:DatabaseScheduler` est recommand√©e si vous utilisez `django-celery-beat` pour stocker les planifications en base de donn√©es.)*

Le bon fonctionnement de ces deux services est crucial pour que toutes les fonctionnalit√©s du syst√®me GoldSentinel soient disponibles et performantes.